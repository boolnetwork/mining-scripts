version: "3"
services:
  bnk-node:
    image: boolnetwork/bnk-node:pre-release
    ports:
      - "9934:9933"
      - "9945:9944"
      - "30335:30333"
    environment:
      RUST_LOG: info
    volumes:
      - ./node-data:/data"
    command: |
      --dev
      --unsafe-rpc-external
      --unsafe-ws-external
      --rpc-cors all

  bnk-database:
    image: boolnetwork/bnk-database:latest
    network_mode: "host"
    # ports:
    #   - "8710:8710"
    environment:
      RUST_LOG: info
    volumes:
      - ./configs/db.toml:/bnk/db.toml
      - ./data:/bnk/data

  bnk-watcher:
    image: boolnetwork/bnk-watcher:latest
    network_mode: "host"
    # ports:
    #     - "8720:8720"
    environment:
        RUST_LOG: info
    volumes:
        - ./configs/watcher.toml:/bnk/watcher.toml
    depends_on:
        - bnk-database

  bnk-sgx-key-server:
    image: boolnetwork/bnk-sgx-key-server:latest
    network_mode: "host"
    # ports:
    #     - "8730:8730"
    environment:
        RUST_LOG: info
    volumes:
        - ./configs/key.toml:/bnk/key.toml
    devices:
        - /dev/sgx/enclave
        - /dev/sgx/provision
    depends_on:
        - bnk-watcher